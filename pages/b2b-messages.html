<!doctype html>
<html lang="tr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Talep Mesajlaşma | Elegance Tur</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        :root {
            --ana: #000;
            --kenar: #e5e7eb;
            --bg: #f6f7fb;
        }

        body {
            background: var(--bg)
        }

        .btn-ana {
            --bs-btn-bg: var(--ana);
            --bs-btn-border-color: var(--ana);
            --bs-btn-hover-bg: #333;
            --bs-btn-hover-border-color: #333;
            color: #fff
        }

        .sidebar {
            min-height: 100vh;
            border-right: 1px solid var(--kenar);
            background: linear-gradient(180deg, #fff, #f8fafc)
        }

        .sidebar .nav-link {
            border-radius: 12px;
            color: #111;
            padding: 10px 12px;
            display: flex;
            gap: .6rem;
            font-weight: 600
        }

        .sidebar .nav-link .ico {
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: #1118270d
        }

        .sidebar .nav-link:hover {
            background: #1118270d
        }

        .sidebar .nav-link.active {
            background: #222;
            color: #fff
        }

        .logo-img {
            height: 32px
        }

        @media (max-width:575.98px) {
            .logo-img {
                height: 44px
            }
        }

        .card-soft {
            background: #fff;
            border: 1px solid var(--kenar);
            border-radius: 14px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, .05)
        }

        /* Chat layout */
        .chat {
            display: flex;
            flex-direction: column;
            height: calc(100vh - 160px)
        }

        @media (min-width:992px) {
            .chat {
                height: calc(100vh - 130px)
            }
        }

        .chat-header {
            border-bottom: 1px solid var(--kenar)
        }

        .chat-body {
            flex: 1;
            overflow: auto;
            padding: 1rem;
            background: #f8fafc
        }

        .chat-compose {
            border-top: 1px solid var(--kenar);
            background: #fff
        }

        /* Messages */
        .msg {
            width: 100%;
            display: flex;
            align-items: flex-end;
            gap: .5rem;
            margin-bottom: .75rem;
        }

        .msg .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            border: 1px solid var(--kenar)
        }

        /* Container for text+meta so max-width uygulanabilsin */
        .msg .content {
            max-width: min(720px, 80%);
            min-width: 0;
        }

        @media (max-width:576px) {
            .msg .content {
                max-width: 92%;
            }
        }

        .bubble {
            width: 100%;
            display: inline-block;
            padding: .6rem .75rem;
            border-radius: 12px;
            border: 1px solid var(--kenar);
            background: #fff;
            /* white-space: pre-wrap; */
            word-break: break-word;
            overflow-wrap: anywhere;
        }

        .bubble a {
            word-break: break-all;
        }

        .meta {
            font-size: .75rem;
            color: #6b7280;
            margin-top: 2px
        }

        /* my messages fully right */
        .msg.mine {
            justify-content: flex-end;
        }

        .msg.mine .content {
            max-width: min(720px, 80%);
        }

        .msg.mine .bubble {
            background: #e7f1ff;
            border-color: #cfe2ff
        }

        .msg.mine .meta {
            text-align: right
        }

        /* Attachments */
        .file-pill {
            display: inline-flex;
            align-items: center;
            gap: .5rem;
            padding: .4rem .6rem;
            border-radius: 999px;
            border: 1px solid #dbe3f0;
            background: #fff;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap
        }

        .file-pill i {
            font-size: 1rem
        }

        /* Composer */
        .input-actions {
            display: flex;
            align-items: center;
            gap: .25rem
        }

        .attach-preview {
            border-top: 1px dashed var(--kenar);
            padding: .5rem;
            display: none
        }

        .attach-item {
            font-size: .875rem
        }

        .typing {
            font-size: .8rem;
            color: #6b7280
        }
    </style>
</head>

<body>
    <!-- NAVBAR -->
    <header class="bg-white border-bottom sticky-top">
        <div class="container-fluid py-2 d-flex align-items-center gap-2">
            <button class="btn btn-outline-dark d-lg-none" data-bs-toggle="offcanvas" data-bs-target="#offSidebar"><i
                    class="bi bi-list"></i></button>
            <img src="/img/logo.png" alt="Elegance Tur" class="ms-1 logo-img">
            <div class="ms-auto d-none d-lg-flex gap-2">
                <a href="#" class="btn btn-outline-secondary btn-sm"><i class="bi bi-arrow-left me-1"></i> Geri</a>
                <button class="btn btn-ana btn-sm"><i class="bi bi-plus-lg me-1"></i> Yeni Talep Oluştur</button>
                <div class="dropdown">
                    <button class="btn btn-outline-dark btn-sm dropdown-toggle" data-bs-toggle="dropdown"><i
                            class="bi bi-person-circle me-1"></i> Hesap</button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#">Profil</a></li>
                        <li><a class="dropdown-item" href="#">Çıkış</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar (lg+) -->
            <aside class="col-lg-2 d-none d-lg-flex sidebar p-3">
                <nav class="nav flex-column gap-1 w-100">
                    <a class="nav-link" href="b2b-panel-v2.html"><span class="ico"><i class="bi bi-house"></i></span>
                        Ana Sayfa</a>
                    <a class="nav-link" href="b2b-tours.html"><span class="ico"><i class="bi bi-briefcase"></i></span>
                        Turlar</a>
                    <a class="nav-link" href="b2b_accounting.html"><span class="ico"><i
                                class="bi bi-cash-stack"></i></span> Muhasebe</a>
                    <button class="nav-link d-flex justify-content-between align-items-center" type="button"
                        data-bs-toggle="collapse" data-bs-target="#menuTalepler" aria-expanded="true">
                        <span class="d-inline-flex align-items-center gap-2">
                            <span class="ico"><i class="bi bi-chat-left-text"></i></span> Talepler
                        </span>
                        <i class="bi bi-chevron-down small"></i>
                    </button>
                    <div class="collapse show" id="menuTalepler">
                        <a class="nav-link ms-4" href="/pages/b2b-request-list.html"><i class="bi bi-list me-2"></i>
                            Talep Listesi</a>
                        <a class="nav-link ms-4" href="/pages/b2b-create-request.html"><i
                                class="bi bi-plus-circle me-2"></i> Talep Oluştur</a>
                        <a class="nav-link active ms-4" href="#"><i class="bi bi-chat-dots me-2"></i> Mesajlaşma</a>
                    </div>
                    <a class="nav-link" href="#"><span class="ico"><i class="bi bi-calendar2-check"></i></span>
                        Rezervasyon Listesi</a>
                </nav>
            </aside>

            <!-- Offcanvas (mobile) -->
            <div class="offcanvas offcanvas-start" tabindex="-1" id="offSidebar">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title">Menü</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
                </div>
                <div class="offcanvas-body d-flex flex-column justify-content-between">
                    <nav class="nav flex-column gap-1">
                        <a class="nav-link" data-bs-dismiss="offcanvas" href="#"><i class="bi bi-house me-2"></i> Ana
                            Sayfa</a>
                        <a class="nav-link" data-bs-dismiss="offcanvas" href="#"><i class="bi bi-briefcase me-2"></i>
                            Turlar</a>
                        <a class="nav-link" data-bs-dismiss="offcanvas" href="#"><i class="bi bi-cash-stack me-2"></i>
                            Muhasebe</a>
                        <div class="mt-2">
                            <div class="text-uppercase small text-muted px-2">Talepler</div>
                            <a class="nav-link ps-4" data-bs-dismiss="offcanvas" href="#"><i
                                    class="bi bi-list me-2"></i> Talep Listesi</a>
                            <a class="nav-link ps-4" data-bs-dismiss="offcanvas" href="#"><i
                                    class="bi bi-plus-circle me-2"></i> Talep Oluştur</a>
                            <a class="nav-link ps-4 active" data-bs-dismiss="offcanvas" href="#"><i
                                    class="bi bi-chat-dots me-2"></i> Mesajlaşma</a>
                        </div>
                        <a class="nav-link" data-bs-dismiss="offcanvas" href="#"><i
                                class="bi bi-calendar2-check me-2"></i> Rezervasyon Listesi</a>
                    </nav>
                    <div class="mt-3">
                        <button class="btn btn-ana w-100 mb-2"><i class="bi bi-plus-lg me-1"></i> Yeni Talep
                            Oluştur</button>
                        <div class="dropdown w-100">
                            <button class="btn btn-outline-dark w-100 dropdown-toggle" data-bs-toggle="dropdown"><i
                                    class="bi bi-person-circle me-1"></i> Hesap</button>
                            <ul class="dropdown-menu w-100">
                                <li><a class="dropdown-item" href="#">Profil</a></li>
                                <li><a class="dropdown-item" href="#">Çıkış</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CONTENT -->
            <main class="col-12 col-lg-10 p-3 p-lg-4">
                <div class="card-soft chat">
                    <!-- chat header -->
                    <div class="chat-header p-3 d-flex align-items-center gap-3 flex-wrap">
                        <div class="d-flex align-items-center gap-2">
                            <div class="rounded-circle bg-primary-subtle d-inline-flex align-items-center justify-content-center"
                                style="width:38px;height:38px">
                                <i class="bi bi-ticket-perforated"></i>
                            </div>
                            <div>
                                <div class="fw-semibold">RZV-2025-01483 • Uçuş saat değişikliği</div>
                                <div class="small text-muted">İlk mesaj: 19/09/2025 11:39 • Talep Sahibi: Ayşe Turizm
                                </div>
                            </div>
                        </div>
                        <div class="ms-auto d-flex align-items-center gap-2">
                            <a class="btn btn-outline-secondary btn-sm" href="#"><i
                                    class="bi bi-box-arrow-left me-1"></i> Listeye Dön</a>
                            <div class="dropdown">
                                <button class="btn btn-outline-dark btn-sm dropdown-toggle" data-bs-toggle="dropdown"><i
                                        class="bi bi-gear me-1"></i> İşlemler</button>
                                <ul class="dropdown-menu dropdown-menu-end">
                                    <li><a class="dropdown-item" href="#"><i class="bi bi-archive me-2"></i> Talebi
                                            Arsivle</a></li>
                                    <li><a class="dropdown-item" href="#"><i class="bi bi-printer me-2"></i> Yazdır /
                                            PDF</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- chat body -->
                    <div class="chat-body" id="chatBody">
                        <!-- karşı taraf -->
                        <div class="msg">
                            <img class="avatar" src="https://i.pravatar.cc/80?img=12" alt="Ayşe Turizm">
                            <div class="content">
                                <div class="bubble">
                                    Lorem ipsum dolor sit, amet consectetur adipisicing elit. Ab asperiores blanditiis
                                    aspernatur,
                                    dignissimos dicta quaerat nulla ex autem quo aut.
                                </div>
                                <div class="meta">Ayşe Turizm • 19/09/2025 11:39</div>
                            </div>
                        </div>

                        <!-- benim mesajım (tam sağ) -->
                        <div class="msg mine">
                            <div class="content">
                                <div class="bubble">Lorem ipsum dolor, sit amet consectetur adipisicing elit. Minus
                                    saepe fugiat sequi nemo ipsam neque temporibus laboriosam voluptas autem architecto
                                    eaque veritatis doloremque harum impedit numquam earum ratione, atque voluptates
                                    nisi id a praesentium aperiam? Lorem ipsum dolor, amet consectetur adipisicing elit.
                                    Minus saepe fugiat sequi nemo ipsam neque temporibus laboriosam voluptas autem
                                    architecto eaque veritatis doloremque harum impedit numquam earum ratione, atque
                                    voluptates nisi id a praesentium aperiam?
                                    <div class="mt-2">
                                        <span class="file-pill"><i class="bi bi-paperclip"></i> PNR_Onay.pdf</span>
                                    </div>
                                </div>
                                <div class="meta">Elegance Operasyon • 19/09/2025 12:02 • Görüldü</div>
                            </div>
                            <img class="avatar" src="https://i.pravatar.cc/80?img=5" alt="Operasyon">
                        </div>

                        <!-- karşı taraf -->
                        <div class="msg">
                            <img class="avatar" src="https://i.pravatar.cc/80?img=12" alt="Ayşe Turizm">
                            <div class="content">
                                <div class="bubble">Lorem ipsum dolor sit, amet consectetur adipisicing elit. Quam,
                                    veritatis?</div>
                                <div class="meta">Ayşe Turizm • 19/09/2025 12:06</div>
                            </div>
                        </div>
                    </div>

                    <!-- composer -->
                    <div class="chat-compose p-2">
                        <form id="composeForm">
                            <div class="d-flex align-items-end gap-2">
                                <div class="flex-grow-1">
                                    <label class="visually-hidden" for="msgInput">Mesaj yazın</label>
                                    <textarea id="msgInput" class="form-control" rows="2"
                                        placeholder="Mesajınızı yazın..."></textarea>
                                    <div class="attach-preview" id="attachPreview"></div>
                                </div>
                                <div class="input-actions">
                                    <label class="btn btn-outline-secondary btn-sm mb-0" for="filePick"
                                        title="Dosya Ekle"><i class="bi bi-paperclip"></i></label>
                                    <input id="filePick" type="file" class="d-none" multiple>
                                    <button class="btn btn-primary btn-sm" id="sendBtn" type="submit"><i
                                            class="bi bi-send me-1"></i> Gönder</button>
                                </div>
                            </div>
                            <div class="typing mt-1" id="typing" style="display:none"><i class="bi bi-three-dots"></i>
                                Yazıyor...</div>
                        </form>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const bodyEl = document.getElementById('chatBody');
        const form = document.getElementById('composeForm');
        const input = document.getElementById('msgInput');
        const filePick = document.getElementById('filePick');
        const preview = document.getElementById('attachPreview');
        const typing = document.getElementById('typing');

        function scrollToBottom() { bodyEl.scrollTop = bodyEl.scrollHeight; }
        scrollToBottom();

        function renderPreview() {
            const files = Array.from(filePick.files || []);
            if (!files.length) { preview.style.display = 'none'; preview.innerHTML = ''; return; }
            preview.style.display = 'block';
            preview.innerHTML = files.map(f => `<div class="attach-item d-flex align-items-center justify-content-between"><span><i class="bi bi-paperclip me-1"></i>${f.name}</span><small class="text-muted">${(f.size / 1024 / 1024).toFixed(2)} MB</small></div>`).join('');
        }
        filePick.addEventListener('change', renderPreview);

        form.addEventListener('submit', function (e) {
            e.preventDefault();
            const text = input.value.trim();
            if (!text && !(filePick.files && filePick.files.length)) return;

            const files = Array.from(filePick.files || []).map(f => `<span class='file-pill'><i class='bi bi-paperclip'></i> ${f.name}</span>`).join(' ');
            const html = `
        <div class="msg mine">
          <div class="content">
            <div class="bubble">${text.replace(/</g, '&lt;').replace(/\n/g, '<br>')}
              ${files ? `<div class="mt-2">${files}</div>` : ''}
            </div>
            <div class="meta">Siz • ${new Date().toLocaleString('tr-TR')}</div>
          </div>
          <img class="avatar" src="https://i.pravatar.cc/80?img=5" alt="Siz">
        </div>`;
            bodyEl.insertAdjacentHTML('beforeend', html);
            input.value = ''; filePick.value = ''; renderPreview();
            scrollToBottom();

            // demo reply
            typing.style.display = 'block';
            setTimeout(() => {
                typing.style.display = 'none';
                const reply = `
          <div class="msg">
            <img class="avatar" src="https://i.pravatar.cc/80?img=12" alt="Karşı Acenta">
            <div class="content">
              <div class="bubble">Bilgi için teşekkürler, gerekli güncellemeyi sağladık. Başka bir sorunuz var mı?</div>
              <div class="meta">Karşı Acenta • ${new Date().toLocaleString('tr-TR')}</div>
            </div>
          </div>`;
                bodyEl.insertAdjacentHTML('beforeend', reply);
                scrollToBottom();
            }, 1200);
        });
    </script>
</body>

</html>